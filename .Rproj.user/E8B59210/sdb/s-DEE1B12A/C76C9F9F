{
    "collab_server" : "",
    "contents" : "library(\"foreign\")\nlibrary(\"DataCombine\")\nlibrary(\"sandwich\")\ndata <- read.dta(\"data.dta\")\n\n#create the lagged wheat_production variable\ndata <- slide(data, Var=\"US_wheat_production\", GroupVar = \"risocode\", slideBy=-1)\nattach(data)\nlagged_wheat_prod <- as.matrix(data[\"US_wheat_production-1\"])\noptions(na.action=\"na.exclude\") #we need to do this to make 2SLS easier\n\n# \naid_by_year <- aggregate(wheat_aid ~ year, FUN=sum)\nwar_freq_by_year <- aggregate(any_war ~ year, FUN=mean)\nwheat_prod_by_year <- aggregate(lagged_wheat_prod ~ year, FUN=mean)\ndf1 <- merge(war_freq_by_year, wheat_prod_by_year)\ndf1 <- merge(df1, aid_by_year)\n\nplot(as.matrix(df1[\"US_wheat_production-1\"]), df1$wheat_aid, xlab=\"Lagged US Wheat Production, (Metric Tons)\", ylab=\"Total US Wheat Aid, (Metric Tons)\")\ntext(as.matrix(df1[\"US_wheat_production-1\"]), df1$wheat_aid, df1$year, cex=0.6, pos=3)\nabline(lm(df1$wheat_aid ~ as.matrix(df1[\"US_wheat_production-1\"])))\n\nplot(as.matrix(df1[\"US_wheat_production-1\"]), df1$any_war, xlab=\"Lagged US Wheat Production, (Metric Tons)\", ylab=\"Frequency of War\")\ntext(as.matrix(df1[\"US_wheat_production-1\"]), df1$any_war, df1$year, cex=0.6, pos=4)\nabline(lm(df1$any_war ~ as.matrix(df1[\"US_wheat_production-1\"])))\n\n# OLS Regressions\nwheat_aid <- wheat_aid/1000\nlagged_wheat_prod <- lagged_wheat_prod/1000\nmodel1 <- lm(any_war ~ wheat_aid + risocode + wb_region*year)\nmodel2 <- lm(any_war ~ wheat_aid + risocode + wb_region*year + USA_rgdpch*fadum_avg + US_president_democ*fadum_avg + oil_price_2011_USD*fadum_avg)\nmodel3 <- lm(any_war ~ wheat_aid + risocode + wb_region*year + USA_rgdpch*fadum_avg + US_president_democ*fadum_avg + oil_price_2011_USD*fadum_avg\n                        + all_Precip_jan + all_Precip_feb + all_Precip_mar + all_Precip_apr + all_Precip_may + all_Precip_jun\n                        + all_Precip_jul + all_Precip_aug + all_Precip_sep + all_Precip_oct + all_Precip_nov + all_Precip_dec\n                        + all_Precip_jan_faavg + all_Precip_feb_faavg + all_Precip_mar_faavg + all_Precip_apr_faavg \n                        + all_Precip_may_faavg + all_Precip_jun_faavg\n                        + all_Precip_jul_faavg + all_Precip_aug_faavg + all_Precip_sep_faavg + all_Precip_oct_faavg \n                        + all_Precip_nov_faavg + all_Precip_dec_faavg\n                        + all_Temp_jan + all_Temp_feb + all_Temp_mar + all_Temp_apr + all_Temp_may + all_Temp_jun\n                        + all_Temp_jul + all_Temp_aug + all_Temp_sep + all_Temp_oct + all_Temp_nov + all_Temp_dec\n                        + all_Temp_jan_faavg + all_Temp_feb_faavg + all_Temp_mar_faavg + all_Temp_apr_faavg \n                        + all_Temp_may_faavg + all_Temp_jun_faavg + all_Temp_jul_faavg + all_Temp_aug_faavg\n                        + all_Temp_sep_faavg + all_Temp_oct_faavg + all_Temp_nov_faavg + all_Temp_dec_faavg)\nmodel4 <- lm(any_war ~ wheat_aid + risocode + wb_region*year + USA_rgdpch*fadum_avg + US_president_democ*fadum_avg + oil_price_2011_USD*fadum_avg\n             + all_Precip_jan + all_Precip_feb + all_Precip_mar + all_Precip_apr + all_Precip_may + all_Precip_jun\n             + all_Precip_jul + all_Precip_aug + all_Precip_sep + all_Precip_oct + all_Precip_nov + all_Precip_dec\n             + all_Precip_jan_faavg + all_Precip_feb_faavg + all_Precip_mar_faavg + all_Precip_apr_faavg \n             + all_Precip_may_faavg + all_Precip_jun_faavg\n             + all_Precip_jul_faavg + all_Precip_aug_faavg + all_Precip_sep_faavg + all_Precip_oct_faavg \n             + all_Precip_nov_faavg + all_Precip_dec_faavg\n             + all_Temp_jan + all_Temp_feb + all_Temp_mar + all_Temp_apr + all_Temp_may + all_Temp_jun\n             + all_Temp_jul + all_Temp_aug + all_Temp_sep + all_Temp_oct + all_Temp_nov + all_Temp_dec\n             + all_Temp_jan_faavg + all_Temp_feb_faavg + all_Temp_mar_faavg + all_Temp_apr_faavg \n             + all_Temp_may_faavg + all_Temp_jun_faavg + all_Temp_jul_faavg + all_Temp_aug_faavg\n             + all_Temp_sep_faavg + all_Temp_oct_faavg + all_Temp_nov_faavg + all_Temp_dec_faavg\n             + real_usmilaid + real_us_nonfoodaid_ecaid)\nmodel5 <- lm(any_war ~ wheat_aid + risocode + wb_region*year + USA_rgdpch*fadum_avg + US_president_democ*fadum_avg + oil_price_2011_USD*fadum_avg\n             + all_Precip_jan + all_Precip_feb + all_Precip_mar + all_Precip_apr + all_Precip_may + all_Precip_jun\n             + all_Precip_jul + all_Precip_aug + all_Precip_sep + all_Precip_oct + all_Precip_nov + all_Precip_dec\n             + all_Precip_jan_faavg + all_Precip_feb_faavg + all_Precip_mar_faavg + all_Precip_apr_faavg \n             + all_Precip_may_faavg + all_Precip_jun_faavg\n             + all_Precip_jul_faavg + all_Precip_aug_faavg + all_Precip_sep_faavg + all_Precip_oct_faavg \n             + all_Precip_nov_faavg + all_Precip_dec_faavg\n             + all_Temp_jan + all_Temp_feb + all_Temp_mar + all_Temp_apr + all_Temp_may + all_Temp_jun\n             + all_Temp_jul + all_Temp_aug + all_Temp_sep + all_Temp_oct + all_Temp_nov + all_Temp_dec\n             + all_Temp_jan_faavg + all_Temp_feb_faavg + all_Temp_mar_faavg + all_Temp_apr_faavg \n             + all_Temp_may_faavg + all_Temp_jun_faavg + all_Temp_jul_faavg + all_Temp_aug_faavg\n             + all_Temp_sep_faavg + all_Temp_oct_faavg + all_Temp_nov_faavg + all_Temp_dec_faavg\n             + real_usmilaid + real_us_nonfoodaid_ecaid\n             + recipient_cereals_prod + cereal_pc_import_quantity_avg*year)\nmodel6 <- lm(intra_state ~ wheat_aid + risocode + wb_region*year + USA_rgdpch*fadum_avg + US_president_democ*fadum_avg + oil_price_2011_USD*fadum_avg\n             + all_Precip_jan + all_Precip_feb + all_Precip_mar + all_Precip_apr + all_Precip_may + all_Precip_jun\n             + all_Precip_jul + all_Precip_aug + all_Precip_sep + all_Precip_oct + all_Precip_nov + all_Precip_dec\n             + all_Precip_jan_faavg + all_Precip_feb_faavg + all_Precip_mar_faavg + all_Precip_apr_faavg \n             + all_Precip_may_faavg + all_Precip_jun_faavg\n             + all_Precip_jul_faavg + all_Precip_aug_faavg + all_Precip_sep_faavg + all_Precip_oct_faavg \n             + all_Precip_nov_faavg + all_Precip_dec_faavg\n             + all_Temp_jan + all_Temp_feb + all_Temp_mar + all_Temp_apr + all_Temp_may + all_Temp_jun\n             + all_Temp_jul + all_Temp_aug + all_Temp_sep + all_Temp_oct + all_Temp_nov + all_Temp_dec\n             + all_Temp_jan_faavg + all_Temp_feb_faavg + all_Temp_mar_faavg + all_Temp_apr_faavg \n             + all_Temp_may_faavg + all_Temp_jun_faavg + all_Temp_jul_faavg + all_Temp_aug_faavg\n             + all_Temp_sep_faavg + all_Temp_oct_faavg + all_Temp_nov_faavg + all_Temp_dec_faavg\n             + real_usmilaid + real_us_nonfoodaid_ecaid\n             + recipient_cereals_prod + cereal_pc_import_quantity_avg*year)\nmodel7 <- lm(inter_state ~ wheat_aid + risocode + wb_region*year + USA_rgdpch*fadum_avg + US_president_democ*fadum_avg + oil_price_2011_USD*fadum_avg\n             + all_Precip_jan + all_Precip_feb + all_Precip_mar + all_Precip_apr + all_Precip_may + all_Precip_jun\n             + all_Precip_jul + all_Precip_aug + all_Precip_sep + all_Precip_oct + all_Precip_nov + all_Precip_dec\n             + all_Precip_jan_faavg + all_Precip_feb_faavg + all_Precip_mar_faavg + all_Precip_apr_faavg \n             + all_Precip_may_faavg + all_Precip_jun_faavg\n             + all_Precip_jul_faavg + all_Precip_aug_faavg + all_Precip_sep_faavg + all_Precip_oct_faavg \n             + all_Precip_nov_faavg + all_Precip_dec_faavg\n             + all_Temp_jan + all_Temp_feb + all_Temp_mar + all_Temp_apr + all_Temp_may + all_Temp_jun\n             + all_Temp_jul + all_Temp_aug + all_Temp_sep + all_Temp_oct + all_Temp_nov + all_Temp_dec\n             + all_Temp_jan_faavg + all_Temp_feb_faavg + all_Temp_mar_faavg + all_Temp_apr_faavg \n             + all_Temp_may_faavg + all_Temp_jun_faavg + all_Temp_jul_faavg + all_Temp_aug_faavg\n             + all_Temp_sep_faavg + all_Temp_oct_faavg + all_Temp_nov_faavg + all_Temp_dec_faavg\n             + real_usmilaid + real_us_nonfoodaid_ecaid\n             + recipient_cereals_prod + cereal_pc_import_quantity_avg*year)\n\nsummary(model1)\nsummary(model2)\nsummary(model3)\nsummary(model4)\nsummary(model5)\nsummary(model6)\nsummary(model7)\nplot(model5)\n\n#First stage Regression for 2SLS\nfs_model1 <- lm(wheat_aid ~ fadum_avg*lagged_wheat_prod + risocode + wb_region*year)\nfs_model2 <- lm(wheat_aid ~ fadum_avg*lagged_wheat_prod + risocode + wb_region*year + USA_rgdpch*fadum_avg + US_president_democ*fadum_avg + oil_price_2011_USD*fadum_avg)\nfs_model3 <- lm(wheat_aid ~ fadum_avg*lagged_wheat_prod + risocode + wb_region*year + USA_rgdpch*fadum_avg + US_president_democ*fadum_avg + oil_price_2011_USD*fadum_avg\n             + all_Precip_jan + all_Precip_feb + all_Precip_mar + all_Precip_apr + all_Precip_may + all_Precip_jun\n             + all_Precip_jul + all_Precip_aug + all_Precip_sep + all_Precip_oct + all_Precip_nov + all_Precip_dec\n             + all_Precip_jan_faavg + all_Precip_feb_faavg + all_Precip_mar_faavg + all_Precip_apr_faavg \n             + all_Precip_may_faavg + all_Precip_jun_faavg\n             + all_Precip_jul_faavg + all_Precip_aug_faavg + all_Precip_sep_faavg + all_Precip_oct_faavg \n             + all_Precip_nov_faavg + all_Precip_dec_faavg\n             + all_Temp_jan + all_Temp_feb + all_Temp_mar + all_Temp_apr + all_Temp_may + all_Temp_jun\n             + all_Temp_jul + all_Temp_aug + all_Temp_sep + all_Temp_oct + all_Temp_nov + all_Temp_dec\n             + all_Temp_jan_faavg + all_Temp_feb_faavg + all_Temp_mar_faavg + all_Temp_apr_faavg \n             + all_Temp_may_faavg + all_Temp_jun_faavg + all_Temp_jul_faavg + all_Temp_aug_faavg\n             + all_Temp_sep_faavg + all_Temp_oct_faavg + all_Temp_nov_faavg + all_Temp_dec_faavg)\nfs_model4 <- lm(wheat_aid ~ fadum_avg*lagged_wheat_prod + risocode + wb_region*year + USA_rgdpch*fadum_avg + US_president_democ*fadum_avg + oil_price_2011_USD*fadum_avg\n             + all_Precip_jan + all_Precip_feb + all_Precip_mar + all_Precip_apr + all_Precip_may + all_Precip_jun\n             + all_Precip_jul + all_Precip_aug + all_Precip_sep + all_Precip_oct + all_Precip_nov + all_Precip_dec\n             + all_Precip_jan_faavg + all_Precip_feb_faavg + all_Precip_mar_faavg + all_Precip_apr_faavg \n             + all_Precip_may_faavg + all_Precip_jun_faavg\n             + all_Precip_jul_faavg + all_Precip_aug_faavg + all_Precip_sep_faavg + all_Precip_oct_faavg \n             + all_Precip_nov_faavg + all_Precip_dec_faavg\n             + all_Temp_jan + all_Temp_feb + all_Temp_mar + all_Temp_apr + all_Temp_may + all_Temp_jun\n             + all_Temp_jul + all_Temp_aug + all_Temp_sep + all_Temp_oct + all_Temp_nov + all_Temp_dec\n             + all_Temp_jan_faavg + all_Temp_feb_faavg + all_Temp_mar_faavg + all_Temp_apr_faavg \n             + all_Temp_may_faavg + all_Temp_jun_faavg + all_Temp_jul_faavg + all_Temp_aug_faavg\n             + all_Temp_sep_faavg + all_Temp_oct_faavg + all_Temp_nov_faavg + all_Temp_dec_faavg\n             + real_usmilaid + real_us_nonfoodaid_ecaid)\nfs_model5 <- lm(wheat_aid ~ fadum_avg*lagged_wheat_prod + risocode + wb_region*year + USA_rgdpch*fadum_avg + US_president_democ*fadum_avg + oil_price_2011_USD*fadum_avg\n             + all_Precip_jan + all_Precip_feb + all_Precip_mar + all_Precip_apr + all_Precip_may + all_Precip_jun\n             + all_Precip_jul + all_Precip_aug + all_Precip_sep + all_Precip_oct + all_Precip_nov + all_Precip_dec\n             + all_Precip_jan_faavg + all_Precip_feb_faavg + all_Precip_mar_faavg + all_Precip_apr_faavg \n             + all_Precip_may_faavg + all_Precip_jun_faavg\n             + all_Precip_jul_faavg + all_Precip_aug_faavg + all_Precip_sep_faavg + all_Precip_oct_faavg \n             + all_Precip_nov_faavg + all_Precip_dec_faavg\n             + all_Temp_jan + all_Temp_feb + all_Temp_mar + all_Temp_apr + all_Temp_may + all_Temp_jun\n             + all_Temp_jul + all_Temp_aug + all_Temp_sep + all_Temp_oct + all_Temp_nov + all_Temp_dec\n             + all_Temp_jan_faavg + all_Temp_feb_faavg + all_Temp_mar_faavg + all_Temp_apr_faavg \n             + all_Temp_may_faavg + all_Temp_jun_faavg + all_Temp_jul_faavg + all_Temp_aug_faavg\n             + all_Temp_sep_faavg + all_Temp_oct_faavg + all_Temp_nov_faavg + all_Temp_dec_faavg\n             + real_usmilaid + real_us_nonfoodaid_ecaid\n             + recipient_cereals_prod + cereal_pc_import_quantity_avg*year)\nsummary(fs_model5)\nplot(fs_model5)\n\n#Second stage regression for 2SLS\n\nss_model1 <- lm(any_war ~ fadum_avg*fitted(fs_model1) + risocode + wb_region*year)\nss_model2 <- lm(any_war ~ fadum_avg*fitted(fs_model2) + risocode + wb_region*year + USA_rgdpch*fadum_avg + US_president_democ*fadum_avg + oil_price_2011_USD*fadum_avg)\nss_model3 <- lm(any_war ~ fadum_avg*fitted(fs_model3) + risocode + wb_region*year + USA_rgdpch*fadum_avg + US_president_democ*fadum_avg + oil_price_2011_USD*fadum_avg\n                + all_Precip_jan + all_Precip_feb + all_Precip_mar + all_Precip_apr + all_Precip_may + all_Precip_jun\n                + all_Precip_jul + all_Precip_aug + all_Precip_sep + all_Precip_oct + all_Precip_nov + all_Precip_dec\n                + all_Precip_jan_faavg + all_Precip_feb_faavg + all_Precip_mar_faavg + all_Precip_apr_faavg \n                + all_Precip_may_faavg + all_Precip_jun_faavg\n                + all_Precip_jul_faavg + all_Precip_aug_faavg + all_Precip_sep_faavg + all_Precip_oct_faavg \n                + all_Precip_nov_faavg + all_Precip_dec_faavg\n                + all_Temp_jan + all_Temp_feb + all_Temp_mar + all_Temp_apr + all_Temp_may + all_Temp_jun\n                + all_Temp_jul + all_Temp_aug + all_Temp_sep + all_Temp_oct + all_Temp_nov + all_Temp_dec\n                + all_Temp_jan_faavg + all_Temp_feb_faavg + all_Temp_mar_faavg + all_Temp_apr_faavg \n                + all_Temp_may_faavg + all_Temp_jun_faavg + all_Temp_jul_faavg + all_Temp_aug_faavg\n                + all_Temp_sep_faavg + all_Temp_oct_faavg + all_Temp_nov_faavg + all_Temp_dec_faavg)\nss_model4 <- lm(any_war ~ fadum_avg*fitted(fs_model3)+ risocode + wb_region*year + USA_rgdpch*fadum_avg + US_president_democ*fadum_avg + oil_price_2011_USD*fadum_avg\n                + all_Precip_jan + all_Precip_feb + all_Precip_mar + all_Precip_apr + all_Precip_may + all_Precip_jun\n                + all_Precip_jul + all_Precip_aug + all_Precip_sep + all_Precip_oct + all_Precip_nov + all_Precip_dec\n                + all_Precip_jan_faavg + all_Precip_feb_faavg + all_Precip_mar_faavg + all_Precip_apr_faavg \n                + all_Precip_may_faavg + all_Precip_jun_faavg\n                + all_Precip_jul_faavg + all_Precip_aug_faavg + all_Precip_sep_faavg + all_Precip_oct_faavg \n                + all_Precip_nov_faavg + all_Precip_dec_faavg\n                + all_Temp_jan + all_Temp_feb + all_Temp_mar + all_Temp_apr + all_Temp_may + all_Temp_jun\n                + all_Temp_jul + all_Temp_aug + all_Temp_sep + all_Temp_oct + all_Temp_nov + all_Temp_dec\n                + all_Temp_jan_faavg + all_Temp_feb_faavg + all_Temp_mar_faavg + all_Temp_apr_faavg \n                + all_Temp_may_faavg + all_Temp_jun_faavg + all_Temp_jul_faavg + all_Temp_aug_faavg\n                + all_Temp_sep_faavg + all_Temp_oct_faavg + all_Temp_nov_faavg + all_Temp_dec_faavg\n                + real_usmilaid + real_us_nonfoodaid_ecaid)\nss_model5 <- lm(any_war ~ fadum_avg*fitted(fs_model4) + risocode + wb_region*year + USA_rgdpch*fadum_avg + US_president_democ*fadum_avg + oil_price_2011_USD*fadum_avg\n                + all_Precip_jan + all_Precip_feb + all_Precip_mar + all_Precip_apr + all_Precip_may + all_Precip_jun\n                + all_Precip_jul + all_Precip_aug + all_Precip_sep + all_Precip_oct + all_Precip_nov + all_Precip_dec\n                + all_Precip_jan_faavg + all_Precip_feb_faavg + all_Precip_mar_faavg + all_Precip_apr_faavg \n                + all_Precip_may_faavg + all_Precip_jun_faavg\n                + all_Precip_jul_faavg + all_Precip_aug_faavg + all_Precip_sep_faavg + all_Precip_oct_faavg \n                + all_Precip_nov_faavg + all_Precip_dec_faavg\n                + all_Temp_jan + all_Temp_feb + all_Temp_mar + all_Temp_apr + all_Temp_may + all_Temp_jun\n                + all_Temp_jul + all_Temp_aug + all_Temp_sep + all_Temp_oct + all_Temp_nov + all_Temp_dec\n                + all_Temp_jan_faavg + all_Temp_feb_faavg + all_Temp_mar_faavg + all_Temp_apr_faavg \n                + all_Temp_may_faavg + all_Temp_jun_faavg + all_Temp_jul_faavg + all_Temp_aug_faavg\n                + all_Temp_sep_faavg + all_Temp_oct_faavg + all_Temp_nov_faavg + all_Temp_dec_faavg\n                + real_usmilaid + real_us_nonfoodaid_ecaid\n                + recipient_cereals_prod + cereal_pc_import_quantity_avg*year)\nss_model6 <- lm(intra_state ~ fadum_avg*fitted(fs_model5) + risocode + wb_region*year + USA_rgdpch*fadum_avg + US_president_democ*fadum_avg + oil_price_2011_USD*fadum_avg\n                + all_Precip_jan + all_Precip_feb + all_Precip_mar + all_Precip_apr + all_Precip_may + all_Precip_jun\n                + all_Precip_jul + all_Precip_aug + all_Precip_sep + all_Precip_oct + all_Precip_nov + all_Precip_dec\n                + all_Precip_jan_faavg + all_Precip_feb_faavg + all_Precip_mar_faavg + all_Precip_apr_faavg \n                + all_Precip_may_faavg + all_Precip_jun_faavg\n                + all_Precip_jul_faavg + all_Precip_aug_faavg + all_Precip_sep_faavg + all_Precip_oct_faavg \n                + all_Precip_nov_faavg + all_Precip_dec_faavg\n                + all_Temp_jan + all_Temp_feb + all_Temp_mar + all_Temp_apr + all_Temp_may + all_Temp_jun\n                + all_Temp_jul + all_Temp_aug + all_Temp_sep + all_Temp_oct + all_Temp_nov + all_Temp_dec\n                + all_Temp_jan_faavg + all_Temp_feb_faavg + all_Temp_mar_faavg + all_Temp_apr_faavg \n                + all_Temp_may_faavg + all_Temp_jun_faavg + all_Temp_jul_faavg + all_Temp_aug_faavg\n                + all_Temp_sep_faavg + all_Temp_oct_faavg + all_Temp_nov_faavg + all_Temp_dec_faavg\n                + real_usmilaid + real_us_nonfoodaid_ecaid\n                + recipient_cereals_prod + cereal_pc_import_quantity_avg*year)\nss_model7 <- lm(inter_state ~ fadum_avg*fitted(fs_model5) + risocode + wb_region*year + USA_rgdpch*fadum_avg + US_president_democ*fadum_avg + oil_price_2011_USD*fadum_avg\n                + all_Precip_jan + all_Precip_feb + all_Precip_mar + all_Precip_apr + all_Precip_may + all_Precip_jun\n                + all_Precip_jul + all_Precip_aug + all_Precip_sep + all_Precip_oct + all_Precip_nov + all_Precip_dec\n                + all_Precip_jan_faavg + all_Precip_feb_faavg + all_Precip_mar_faavg + all_Precip_apr_faavg \n                + all_Precip_may_faavg + all_Precip_jun_faavg\n                + all_Precip_jul_faavg + all_Precip_aug_faavg + all_Precip_sep_faavg + all_Precip_oct_faavg \n                + all_Precip_nov_faavg + all_Precip_dec_faavg\n                + all_Temp_jan + all_Temp_feb + all_Temp_mar + all_Temp_apr + all_Temp_may + all_Temp_jun\n                + all_Temp_jul + all_Temp_aug + all_Temp_sep + all_Temp_oct + all_Temp_nov + all_Temp_dec\n                + all_Temp_jan_faavg + all_Temp_feb_faavg + all_Temp_mar_faavg + all_Temp_apr_faavg \n                + all_Temp_may_faavg + all_Temp_jun_faavg + all_Temp_jul_faavg + all_Temp_aug_faavg\n                + all_Temp_sep_faavg + all_Temp_oct_faavg + all_Temp_nov_faavg + all_Temp_dec_faavg\n                + real_usmilaid + real_us_nonfoodaid_ecaid\n                + recipient_cereals_prod + cereal_pc_import_quantity_avg*year)\n\nsummary(ss_model1)\nsummary(ss_model2)\nsummary(ss_model3)\nsummary(ss_model4)\nsummary(ss_model5)\nsummary(ss_model6)\nsummary(ss_model7)\nplot(ss_model5)\n\n#Breusch-Pagan test for Heteroscedasticity\n\nresid5.2 <- resid(model5)^2\nresid_model5 <- lm(resid5.2 ~  wheat_aid + risocode + wb_region*year + USA_rgdpch*fadum_avg + US_president_democ*fadum_avg + oil_price_2011_USD*fadum_avg\n                  + all_Precip_jan + all_Precip_feb + all_Precip_mar + all_Precip_apr + all_Precip_may + all_Precip_jun\n                  + all_Precip_jul + all_Precip_aug + all_Precip_sep + all_Precip_oct + all_Precip_nov + all_Precip_dec\n                  + all_Precip_jan_faavg + all_Precip_feb_faavg + all_Precip_mar_faavg + all_Precip_apr_faavg \n                  + all_Precip_may_faavg + all_Precip_jun_faavg\n                  + all_Precip_jul_faavg + all_Precip_aug_faavg + all_Precip_sep_faavg + all_Precip_oct_faavg \n                  + all_Precip_nov_faavg + all_Precip_dec_faavg\n                  + all_Temp_jan + all_Temp_feb + all_Temp_mar + all_Temp_apr + all_Temp_may + all_Temp_jun\n                  + all_Temp_jul + all_Temp_aug + all_Temp_sep + all_Temp_oct + all_Temp_nov + all_Temp_dec\n                  + all_Temp_jan_faavg + all_Temp_feb_faavg + all_Temp_mar_faavg + all_Temp_apr_faavg \n                  + all_Temp_may_faavg + all_Temp_jun_faavg + all_Temp_jul_faavg + all_Temp_aug_faavg\n                  + all_Temp_sep_faavg + all_Temp_oct_faavg + all_Temp_nov_faavg + all_Temp_dec_faavg\n                  + real_usmilaid + real_us_nonfoodaid_ecaid\n                  + recipient_cereals_prod + cereal_pc_import_quantity_avg*year)\nsummary(resid_model5)\nnR5.2 <- length(resid_model5$fitted.values) * summary(resid_model5)$r.squared\nlength(resid_model5$fitted.values)\nnR5.2\n1 - pchisq(nR5.2, length(resid_model5$fitted.values))\n\nresid6.2 <- resid(model6)^2\nresid_model6 <- lm(resid6.2 ~ wheat_aid + risocode + wb_region*year + USA_rgdpch*fadum_avg + US_president_democ*fadum_avg + oil_price_2011_USD*fadum_avg\n             + all_Precip_jan + all_Precip_feb + all_Precip_mar + all_Precip_apr + all_Precip_may + all_Precip_jun\n             + all_Precip_jul + all_Precip_aug + all_Precip_sep + all_Precip_oct + all_Precip_nov + all_Precip_dec\n             + all_Precip_jan_faavg + all_Precip_feb_faavg + all_Precip_mar_faavg + all_Precip_apr_faavg \n             + all_Precip_may_faavg + all_Precip_jun_faavg\n             + all_Precip_jul_faavg + all_Precip_aug_faavg + all_Precip_sep_faavg + all_Precip_oct_faavg \n             + all_Precip_nov_faavg + all_Precip_dec_faavg\n             + all_Temp_jan + all_Temp_feb + all_Temp_mar + all_Temp_apr + all_Temp_may + all_Temp_jun\n             + all_Temp_jul + all_Temp_aug + all_Temp_sep + all_Temp_oct + all_Temp_nov + all_Temp_dec\n             + all_Temp_jan_faavg + all_Temp_feb_faavg + all_Temp_mar_faavg + all_Temp_apr_faavg \n             + all_Temp_may_faavg + all_Temp_jun_faavg + all_Temp_jul_faavg + all_Temp_aug_faavg\n             + all_Temp_sep_faavg + all_Temp_oct_faavg + all_Temp_nov_faavg + all_Temp_dec_faavg\n             + real_usmilaid + real_us_nonfoodaid_ecaid\n             + recipient_cereals_prod + cereal_pc_import_quantity_avg*year)\nnR6.2 <- length(resid_model6$fitted.values) * summary(resid_model6)$r.squared\nlength(resid_model6$fitted.values)\nnR6.2\n1 - pchisq(nR6.2, length(resid_model6$fitted.values))\n\nss_resid2 <- resid(ss_model5)^2\nss_resid_model <- lm(ss_resid2 ~ fadum_avg*fitted(fs_model4) + risocode + wb_region*year + USA_rgdpch*fadum_avg + US_president_democ*fadum_avg + oil_price_2011_USD*fadum_avg\n                + all_Precip_jan + all_Precip_feb + all_Precip_mar + all_Precip_apr + all_Precip_may + all_Precip_jun\n                + all_Precip_jul + all_Precip_aug + all_Precip_sep + all_Precip_oct + all_Precip_nov + all_Precip_dec\n                + all_Precip_jan_faavg + all_Precip_feb_faavg + all_Precip_mar_faavg + all_Precip_apr_faavg \n                + all_Precip_may_faavg + all_Precip_jun_faavg\n                + all_Precip_jul_faavg + all_Precip_aug_faavg + all_Precip_sep_faavg + all_Precip_oct_faavg \n                + all_Precip_nov_faavg + all_Precip_dec_faavg\n                + all_Temp_jan + all_Temp_feb + all_Temp_mar + all_Temp_apr + all_Temp_may + all_Temp_jun\n                + all_Temp_jul + all_Temp_aug + all_Temp_sep + all_Temp_oct + all_Temp_nov + all_Temp_dec\n                + all_Temp_jan_faavg + all_Temp_feb_faavg + all_Temp_mar_faavg + all_Temp_apr_faavg \n                + all_Temp_may_faavg + all_Temp_jun_faavg + all_Temp_jul_faavg + all_Temp_aug_faavg\n                + all_Temp_sep_faavg + all_Temp_oct_faavg + all_Temp_nov_faavg + all_Temp_dec_faavg\n                + real_usmilaid + real_us_nonfoodaid_ecaid\n                + recipient_cereals_prod + cereal_pc_import_quantity_avg*year)\nsummary(ss_resid_model)\nnR2 <- length(ss_resid_model$fitted.values) * summary(ss_resid_model)$r.squared\n1 - pchisq(nR2,length(ss_resid_model$fitted.values))\n\nss_resid6.2 <- resid(ss_model6)^2\nss_resid_model6 <- lm(ss_resid6.2 ~ fadum_avg*fitted(fs_model4) + risocode + wb_region*year + USA_rgdpch*fadum_avg + US_president_democ*fadum_avg + oil_price_2011_USD*fadum_avg\n                     + all_Precip_jan + all_Precip_feb + all_Precip_mar + all_Precip_apr + all_Precip_may + all_Precip_jun\n                     + all_Precip_jul + all_Precip_aug + all_Precip_sep + all_Precip_oct + all_Precip_nov + all_Precip_dec\n                     + all_Precip_jan_faavg + all_Precip_feb_faavg + all_Precip_mar_faavg + all_Precip_apr_faavg \n                     + all_Precip_may_faavg + all_Precip_jun_faavg\n                     + all_Precip_jul_faavg + all_Precip_aug_faavg + all_Precip_sep_faavg + all_Precip_oct_faavg \n                     + all_Precip_nov_faavg + all_Precip_dec_faavg\n                     + all_Temp_jan + all_Temp_feb + all_Temp_mar + all_Temp_apr + all_Temp_may + all_Temp_jun\n                     + all_Temp_jul + all_Temp_aug + all_Temp_sep + all_Temp_oct + all_Temp_nov + all_Temp_dec\n                     + all_Temp_jan_faavg + all_Temp_feb_faavg + all_Temp_mar_faavg + all_Temp_apr_faavg \n                     + all_Temp_may_faavg + all_Temp_jun_faavg + all_Temp_jul_faavg + all_Temp_aug_faavg\n                     + all_Temp_sep_faavg + all_Temp_oct_faavg + all_Temp_nov_faavg + all_Temp_dec_faavg\n                     + real_usmilaid + real_us_nonfoodaid_ecaid\n                     + recipient_cereals_prod + cereal_pc_import_quantity_avg*year)\nsummary(ss_resid_model6)\nnR2 <- length(ss_resid_model6$fitted.values) * summary(ss_resid_model6)$r.squared\nlength(ss_resid_model6$fitted.values)\n1 - pchisq(nR2,length(ss_resid_model6$fitted.values))\n\n#Haussmann Test for Endogeneity\nmodel5Haussmann <- lm(any_war ~ wheat_aid + risocode + wb_region*year + USA_rgdpch*fadum_avg + US_president_democ*fadum_avg + oil_price_2011_USD*fadum_avg\n                      + all_Precip_jan + all_Precip_feb + all_Precip_mar + all_Precip_apr + all_Precip_may + all_Precip_jun\n                      + all_Precip_jul + all_Precip_aug + all_Precip_sep + all_Precip_oct + all_Precip_nov + all_Precip_dec\n                      + all_Precip_jan_faavg + all_Precip_feb_faavg + all_Precip_mar_faavg + all_Precip_apr_faavg \n                      + all_Precip_may_faavg + all_Precip_jun_faavg\n                      + all_Precip_jul_faavg + all_Precip_aug_faavg + all_Precip_sep_faavg + all_Precip_oct_faavg \n                      + all_Precip_nov_faavg + all_Precip_dec_faavg\n                      + all_Temp_jan + all_Temp_feb + all_Temp_mar + all_Temp_apr + all_Temp_may + all_Temp_jun\n                      + all_Temp_jul + all_Temp_aug + all_Temp_sep + all_Temp_oct + all_Temp_nov + all_Temp_dec\n                      + all_Temp_jan_faavg + all_Temp_feb_faavg + all_Temp_mar_faavg + all_Temp_apr_faavg \n                      + all_Temp_may_faavg + all_Temp_jun_faavg + all_Temp_jul_faavg + all_Temp_aug_faavg\n                      + all_Temp_sep_faavg + all_Temp_oct_faavg + all_Temp_nov_faavg + all_Temp_dec_faavg\n                      + real_usmilaid + real_us_nonfoodaid_ecaid\n                      + recipient_cereals_prod + cereal_pc_import_quantity_avg*year\n                      + resid(fs_model5))\nvcov_H <- vcov(model5Haussmann)[\"resid(fs_model5)\", \"resid(fs_model5)\"]\nbeta_H <- coef(model5Haussmann)[\"resid(fs_model5)\"]\nF_stat <-t(beta_H)%*%solve(vcov_H)%*%beta_H\nF_stat\n1-pchisq(F_stat,1)\n\nmodel6Haussmann <- lm(intra_state ~ wheat_aid + risocode + wb_region*year + USA_rgdpch*fadum_avg + US_president_democ*fadum_avg + oil_price_2011_USD*fadum_avg\n                      + all_Precip_jan + all_Precip_feb + all_Precip_mar + all_Precip_apr + all_Precip_may + all_Precip_jun\n                      + all_Precip_jul + all_Precip_aug + all_Precip_sep + all_Precip_oct + all_Precip_nov + all_Precip_dec\n                      + all_Precip_jan_faavg + all_Precip_feb_faavg + all_Precip_mar_faavg + all_Precip_apr_faavg \n                      + all_Precip_may_faavg + all_Precip_jun_faavg\n                      + all_Precip_jul_faavg + all_Precip_aug_faavg + all_Precip_sep_faavg + all_Precip_oct_faavg \n                      + all_Precip_nov_faavg + all_Precip_dec_faavg\n                      + all_Temp_jan + all_Temp_feb + all_Temp_mar + all_Temp_apr + all_Temp_may + all_Temp_jun\n                      + all_Temp_jul + all_Temp_aug + all_Temp_sep + all_Temp_oct + all_Temp_nov + all_Temp_dec\n                      + all_Temp_jan_faavg + all_Temp_feb_faavg + all_Temp_mar_faavg + all_Temp_apr_faavg \n                      + all_Temp_may_faavg + all_Temp_jun_faavg + all_Temp_jul_faavg + all_Temp_aug_faavg\n                      + all_Temp_sep_faavg + all_Temp_oct_faavg + all_Temp_nov_faavg + all_Temp_dec_faavg\n                      + real_usmilaid + real_us_nonfoodaid_ecaid\n                      + recipient_cereals_prod + cereal_pc_import_quantity_avg*year\n                      + resid(fs_model5))\nvcov_H <- vcov(model6Haussmann)[\"resid(fs_model5)\", \"resid(fs_model5)\"]\nbeta_H <- coef(model6Haussmann)[\"resid(fs_model5)\"]\nF_stat <-t(beta_H)%*%solve(vcov_H)%*%beta_H\nF_stat\n1-pchisq(F_stat,1)\n\n#Sagran test for validity of overidentification assumption\nhat_resid <- resid(ss_model5)\nmodel5Sargan <- lm(hat_resid ~ wheat_aid + risocode + wb_region*year + USA_rgdpch*fadum_avg + US_president_democ*fadum_avg + oil_price_2011_USD*fadum_avg\n                   + all_Precip_jan + all_Precip_feb + all_Precip_mar + all_Precip_apr + all_Precip_may + all_Precip_jun\n                   + all_Precip_jul + all_Precip_aug + all_Precip_sep + all_Precip_oct + all_Precip_nov + all_Precip_dec\n                   + all_Precip_jan_faavg + all_Precip_feb_faavg + all_Precip_mar_faavg + all_Precip_apr_faavg \n                   + all_Precip_may_faavg + all_Precip_jun_faavg\n                   + all_Precip_jul_faavg + all_Precip_aug_faavg + all_Precip_sep_faavg + all_Precip_oct_faavg \n                   + all_Precip_nov_faavg + all_Precip_dec_faavg\n                   + all_Temp_jan + all_Temp_feb + all_Temp_mar + all_Temp_apr + all_Temp_may + all_Temp_jun\n                   + all_Temp_jul + all_Temp_aug + all_Temp_sep + all_Temp_oct + all_Temp_nov + all_Temp_dec\n                   + all_Temp_jan_faavg + all_Temp_feb_faavg + all_Temp_mar_faavg + all_Temp_apr_faavg \n                   + all_Temp_may_faavg + all_Temp_jun_faavg + all_Temp_jul_faavg + all_Temp_aug_faavg\n                   + all_Temp_sep_faavg + all_Temp_oct_faavg + all_Temp_nov_faavg + all_Temp_dec_faavg\n                   + real_usmilaid + real_us_nonfoodaid_ecaid\n                   + recipient_cereals_prod + cereal_pc_import_quantity_avg*year)\nsummary(model5Sargan)\nnR_u2<- length(fitted(model5Sargan)) * (summary(model5Sargan)$r.squared)\nnR_u2\n1-pchisq(nR_u2, length(fitted(model5Sargan))) \n\nhat_resid6 <- resid(ss_model6)\nmodel6Sargan <- lm(hat_resid6 ~ wheat_aid + risocode + wb_region*year + USA_rgdpch*fadum_avg + US_president_democ*fadum_avg + oil_price_2011_USD*fadum_avg\n                   + all_Precip_jan + all_Precip_feb + all_Precip_mar + all_Precip_apr + all_Precip_may + all_Precip_jun\n                   + all_Precip_jul + all_Precip_aug + all_Precip_sep + all_Precip_oct + all_Precip_nov + all_Precip_dec\n                   + all_Precip_jan_faavg + all_Precip_feb_faavg + all_Precip_mar_faavg + all_Precip_apr_faavg \n                   + all_Precip_may_faavg + all_Precip_jun_faavg\n                   + all_Precip_jul_faavg + all_Precip_aug_faavg + all_Precip_sep_faavg + all_Precip_oct_faavg \n                   + all_Precip_nov_faavg + all_Precip_dec_faavg\n                   + all_Temp_jan + all_Temp_feb + all_Temp_mar + all_Temp_apr + all_Temp_may + all_Temp_jun\n                   + all_Temp_jul + all_Temp_aug + all_Temp_sep + all_Temp_oct + all_Temp_nov + all_Temp_dec\n                   + all_Temp_jan_faavg + all_Temp_feb_faavg + all_Temp_mar_faavg + all_Temp_apr_faavg \n                   + all_Temp_may_faavg + all_Temp_jun_faavg + all_Temp_jul_faavg + all_Temp_aug_faavg\n                   + all_Temp_sep_faavg + all_Temp_oct_faavg + all_Temp_nov_faavg + all_Temp_dec_faavg\n                   + real_usmilaid + real_us_nonfoodaid_ecaid\n                   + recipient_cereals_prod + cereal_pc_import_quantity_avg*year)\nsummary(model6Sargan)\nnR_u2<- length(fitted(model6Sargan)) * (summary(model6Sargan)$r.squared)\nnR_u2\n1-pchisq(nR_u2, length(fitted(model6Sargan))) ",
    "created" : 1513073745876.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3789918868",
    "id" : "C76C9F9F",
    "lastKnownWriteTime" : 1513170751,
    "last_content_update" : 1513170751515,
    "path" : "~/Documents/STAT520/FinalProject/script.R",
    "project_path" : "script.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}